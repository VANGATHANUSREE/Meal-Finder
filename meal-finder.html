<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meals Finder</title>
    <link href="meal-finder.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gIHRqZ0gaNUVZ57afZpqeXk" crossorigin="anonymous"></script>
</head>
<body>
    <nav class="navbar">
    <div class="container">
        <a href="#" class="navbar-brand text-white">
            <i class="fa-solid fa-utensils"></i> Meal Finder
        </a>
        <button class="navbar-toggler text-white" type="button" id="menu-btn">
            <span class="navbar-toggler-icon text-white" style="filter:  brightness(0) invert(1);" ></span>
        </button>
        <div id="navbarSupportedContent" class="collapse navbar-collapse">
            <ul>
                <li id="close-btn"><i class="fa-solid fa-xmark"></i></li>
                <li id="category-list"></li>
            </ul>
        </div>
    </div>
</nav>
<div class="background">
    <div class="search-container">
        <input type="text" class="search_bar" placeholder="Search recipes here ..."> 
        <span><i class="fa-solid fa-magnifying-glass" id="search_icon" onclick="searchMeals()"></i></span>
    </div>
    <p><span class="text">What are your favorite cuisines?</span></br>
        PERSONALIZE YOUR EXPERIENCE
    </p>
</div>
<div id="categories">
    <h2>CATEGORIES</h2>
</div>
<div id="meal-list"></div>
<script>
// fetching the info 
fetch('https://www.themealdb.com/api/json/v1/1/categories.php')
.then(res => res.json())
.then(data => {
// declaring variables for required sections to add the required info and fetching of data to html
let categoriesHtml = '<h2>CATEGORIES</h2>';
let html = '';
data.categories.forEach(category => {
// fetching the images to display in category section
categoriesHtml += `
  <div style="display: inline-block; margin: 10px;">
    <img src="${category.strCategoryThumb}" alt="${category.strCategory}" onclick="getMealsByCategory('${category.strCategory}')">${category.strCategory}
  </div>
`;
// fetching the category names to display in toogle menu
html += `
  <li style="background-color: white;">
    <a href="#" style="color: black;" onclick="getMeals('${category.strCategory}')">${category.strCategory}</a>
  </li>
`;
});
document.getElementById('categories').innerHTML = categoriesHtml;
document.getElementById('category-list').innerHTML = html;
});
//  adding the functionality to toogle menu to display the list items when clicked
document.getElementById('menu-btn').addEventListener('click', function() {
document.getElementById('navbarSupportedContent').classList.toggle('show');
});
//  adding the functionality to close button to close the display list of the toogle menu
document.getElementById('close-btn').addEventListener('click', function() {
document.getElementById('navbarSupportedContent').classList.remove('show');
});
//  adding functionality to the list items to display the corresponding items of the category when clicked 
function getMeals(category) {
fetch(`https://www.themealdb.com/api/json/v1/1/filter.php?c=${category}`)
.then(res => res.json())
.then(data => {
  let mealHtml = '';
  data.meals.forEach(meal => {
    mealHtml += `
      <li>
        <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
        <a href="#" style="color: black;">${meal.strMeal}</a>
      </li>
    `;
  });
  document.getElementById('meal-list').innerHTML = mealHtml;
});
}
// adding functionality to the search to display the corresponding items when searched
function searchMeals() {
const searchQuery = document.querySelector('.search_bar').value.trim();
if (searchQuery) {
fetch(`https://www.themealdb.com/api/json/v1/1/search.php?s=${searchQuery}`)
  .then(res => res.json())
  .then(data => {
    let mealHtml = '';
    if (data.meals) {
      data.meals.forEach(meal => {
        mealHtml += `
          <li>
            <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
            <a href="#" style="color: black;">${meal.strMeal}</a>
          </li>
        `;
      });
    } else {
      mealHtml = `<p style="color: red; font-weight: bolder; font-size: 50px">No Meals Found!</p>`;
    }
    document.getElementById('meal-list').innerHTML = mealHtml;
  })
}
}
// adding the functionality to the images that displayed in the categories section when clicked on the image the corresponding items of the category 
function getMealsByCategory(category) {
  // Fetch category description
  fetch(`https://www.themealdb.com/api/json/v1/1/categories.php`)
    .then(res => res.json())
    .then(data => {
      const categoryDescription = data.categories.find(cat => cat.strCategory === category).strCategoryDescription;
      
      // Fetch meals
      fetch(`https://www.themealdb.com/api/json/v1/1/filter.php?c=${category}`)
        .then(res => res.json())
        .then(data => {
          let mealHtml = '';
          mealHtml += `
                        <p style="border:2px solid orange; margin:50px; padding:5px">${categoryDescription}</p>
                        <h2 style= "text-decoration-color:orange; border-bottom:5px solid orange; padding-bottom:5px;  width: 100px; display: inline-block;">Meals</h2>
                        <div class="category-images">`; // added container div
          data.meals.forEach(meal => {
            mealHtml += `
              <div>
                <img src="${meal.strMealThumb}" alt="${meal.strMeal}" onclick="getMealDetails('${meal.idMeal}')">
                <p><a href="#" style="color: black; text">${meal.strMeal}</a></p>
              </div>
            `;
          });
          mealHtml += `</div>`; // closing container div
          document.getElementById('category-description').innerHTML = mealHtml;
        });
    });
}
</script>
</body>
</html>